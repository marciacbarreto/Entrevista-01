<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Entrevista IA - Modo Executivo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
</head>

<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 min-h-screen flex flex-col items-center justify-center p-4">
  <div id="app" class="w-full max-w-4xl bg-white rounded-2xl shadow-2xl p-8"></div>

  <script>
    const { useState, useEffect, createElement: h } = React;

    // 🔍 Função para extrair palavras-chave
    function extractKeywords(text) {
      const tools = ["power bi", "excel", "jira", "crm", "salesforce", "hubspot"];
      const metrics = ["nps", "csat", "ces", "churn", "retenção", "expansão"];
      const roles = ["customer success", "customer experience", "cx", "suporte", "gestão", "vendas", "b2b"];
      const found = (list) => list.filter(w => text.toLowerCase().includes(w));
      return { tools: found(tools), metrics: found(metrics), roles: found(roles) };
    }

    // 🔠 Capitaliza texto
    function capitalize(s) {
      return s.charAt(0).toUpperCase() + s.slice(1);
    }

    // ✨ Nova função com IA simulada (sem OpenAI)
    function generateExecutiveAnswer({ question, resume, job }) {
      const rk = extractKeywords(resume);
      const jk = extractKeywords(job);
      const tools = [...new Set([...(jk.tools || []), ...(rk.tools || [])])].slice(0, 3);
      const metrics = [...new Set([...(jk.metrics || []), ...(rk.metrics || [])])].slice(0, 3);
      const roleHint = (jk.roles[0] || rk.roles[0] || "Customer Experience");

      const toolsStr = tools.length ? tools.map(capitalize).join(" e ") : "Power BI e Excel";
      const metricsStr = metrics.length ? metrics.map(s => s.toUpperCase()).join(" e ") : "NPS e CSAT";

      const q = question.toLowerCase();

      if (q.includes("venda") || q.includes("b2b") || q.includes("contas")) {
        return `Sim, tenho experiência sólida em vendas consultivas e gestão de contas B2B.
Durante minha trajetória, integrei estratégias de Customer Success e áreas comerciais,
criando fluxos de acompanhamento, expansão e fidelização de clientes corporativos.
Utilizei ferramentas como ${toolsStr} para análise de performance e identificação de oportunidades de upsell e retenção.
Além disso, implementei métricas como ${metricsStr} para medir satisfação e crescimento de receita recorrente.`;
      }

      if (q.includes("estruturaria") || q.includes("estruturaria a área") || q.includes("estruturação")) {
        return `Eu estruturaria a área com foco em eficiência operacional e clareza de processos.
Iniciaria com um diagnóstico rápido, mapeando fluxos e gargalos, aplicando ferramentas como ${toolsStr} para mensurar resultados.
Definiria metas e entregas semanais alinhadas aos indicadores ${metricsStr}, garantindo agilidade, clareza e integração entre os times.`;
      }

      if (q.includes("lider") || q.includes("gestao") || q.includes("equipe")) {
        return `Minha abordagem de liderança é centrada em pessoas e resultados.
Atuo definindo objetivos claros e acompanhando indicadores como ${metricsStr}.
Valorizo autonomia, melhoria contínua e cultura de dados — uso ${toolsStr} para decisões baseadas em fatos e não em percepções.`;
      }

      return `Na minha última experiência, comecei estruturando a área com foco em eficiência operacional e experiência do cliente.
Realizei um diagnóstico dos fluxos de atendimento, identifiquei gargalos e implementei processos padronizados com acompanhamento via ${toolsStr}.
Desenvolvi um modelo de ${capitalize(roleHint)} com metas de ${metricsStr}, além de integrar times de Suporte, CX e Produto para garantir uma visão única do cliente.

Para esta oportunidade, aplicaria a mesma metodologia — iniciando pelo mapeamento da jornada, definição de KPIs de retenção, engajamento e expansão.
Estabeleceria rituais de melhoria contínua (reviews semanais e mensais), usaria ${toolsStr} para monitoramento e criaria um playbook de relacionamento alinhado aos objetivos estratégicos da empresa.`;
    }

    // 💼 Componente principal
    function InterviewApp() {
      const [resume, setResume] = useState("");
      const [job, setJob] = useState("");
      const [question, setQuestion] = useState("");
      const [answer, setAnswer] = useState("");
      const [session, setSession] = useState(Date.now());

      // 🔄 Atualiza resposta automaticamente
      useEffect(() => {
        if (question.trim().length > 5 && resume && job) {
          const r = generateExecutiveAnswer({ question, resume, job });
          setAnswer(r);
        } else {
          setAnswer("");
        }
      }, [question, resume, job]);

      // 🧹 Reset
      const reset = () => {
        setResume("");
        setJob("");
        setQuestion("");
        setAnswer("");
        setSession(Date.now());
      };

      return h("div", { className: "space-y-8" },

        h("h1", { className: "text-3xl font-bold text-indigo-700 flex items-center gap-2" },
          "🎤 Modo Entrevista"
        ),

        h("p", { className: "text-gray-600 mb-4" },
          "Cole seu currículo e a descrição da vaga para gerar respostas personalizadas."
        ),

        // 🧾 Campos de entrada
        h("textarea", {
          className: "w-full border rounded-xl p-4 h-28 shadow-sm focus:ring-2 focus:ring-indigo-400",
          placeholder: "Cole aqui o currículo...",
          value: resume,
          onChange: (e) => setResume(e.target.value)
        }),
        h("textarea", {
          className: "w-full border rounded-xl p-4 h-28 shadow-sm focus:ring-2 focus:ring-indigo-400",
          placeholder: "Cole aqui a descrição da vaga...",
          value: job,
          onChange: (e) => setJob(e.target.value)
        }),

        // 🎤 Pergunta do recrutador
        h("div", { className: "mt-8" },
          h("p", { className: "text-gray-700 mb-2 font-medium" }, "Digite ou fale a pergunta do recrutador:"),
          h("textarea", {
            className: "w-full border rounded-xl p-4 h-24 focus:ring-2 focus:ring-purple-400",
            placeholder: "Ex: Como você estruturaria a área?",
            value: question,
            onChange: (e) => setQuestion(e.target.value)
          })
        ),

        // ⚡ Botões
        h("div", { className: "flex gap-4 mt-4" },
          h("button", {
            className: "bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-semibold shadow-md",
            onClick: () => setQuestion(""),
          }, "🎙️ Gravar pergunta"),
          h("button", {
            className: "bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-semibold shadow-md",
            onClick: () => {
              const r = generateExecutiveAnswer({ question, resume, job });
              setAnswer(r);
            },
          }, "⚡ Gerar resposta"),
          h("button", {
            className: "ml-auto bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg font-semibold",
            onClick: reset
          }, "🆕 Nova Vaga / Currículo")
        ),

        // 💬 Resposta
        answer && h("div", { className: "mt-8 p-6 bg-indigo-50 border border-indigo-100 rounded-xl shadow-inner" },
          h("p", { className: "font-semibold text-indigo-700 mb-2" }, "✨ Resposta sugerida (modelo executivo e natural):"),
          h("p", { className: "text-gray-700 whitespace-pre-line leading-relaxed" }, answer)
        ),

        h("p", { className: "text-sm text-gray-500 mt-6" },
          "💡 Dica rápida: use o microfone para capturar perguntas discretamente durante entrevistas online."
        )
      );
    }

    ReactDOM.createRoot(document.getElementById("app")).render(h(InterviewApp));
  </script>
</body>
</html>
