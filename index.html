<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Entrevista IA - Respostas Inteligentes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
</head>

<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 min-h-screen">
  <div id="app"></div>

  <script>
    const { useState, createElement: h } = React;

    function App() {
      const [isLoggedIn, setIsLoggedIn] = useState(false);
      const [email, setEmail] = useState("");
      const [senha, setSenha] = useState("");
      const [erro, setErro] = useState("");
      const [resume, setResume] = useState("");
      const [jobDescription, setJobDescription] = useState("");
      const [question, setQuestion] = useState("");
      const [isProcessing, setIsProcessing] = useState(false);
      const [currentAnswer, setCurrentAnswer] = useState(null);
      const [conversationHistory, setConversationHistory] = useState([]);

      // 🔐 Credenciais fixas para acesso
      const loginCorreto = "admin@entrevistaia.com";
      const senhaCorreta = "2025ia";

      // Função de login
      const handleLogin = () => {
        if (email === loginCorreto && senha === senhaCorreta) {
          setIsLoggedIn(true);
          setErro("");
        } else {
          setErro("E-mail ou senha incorretos. Tente novamente.");
        }
      };

      // Função principal de geração de resposta com IA
      const generateAnswer = async (userQuestion) => {
        setIsProcessing(true);

        try {
          const prompt = `
Você é um assistente de entrevistas chamado Entrevista IA.
Gere uma resposta ideal para uma entrevista de emprego com base nas informações a seguir:

🧾 Currículo do candidato:
${resume}

💼 Descrição da vaga:
${jobDescription}

❓ Pergunta do recrutador:
"${userQuestion}"

Sua resposta deve ser:
- Clara, natural e confiante;
- Focada em resultados e habilidades compatíveis com a vaga;
- Escrita em português do Brasil;
- Curta e convincente (até 6 linhas);
- Tom profissional, empático e seguro, como um candidato pronto para a vaga.
          `;

          // 🔗 Conexão com API da OpenAI
          const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "Authorization": "Bearer SUA_CHAVE_OPENAI_AQUI" // <-- coloque sua chave da OpenAI aqui
            },
            body: JSON.stringify({
              model: "gpt-4-turbo",
              messages: [{ role: "user", content: prompt }],
              temperature: 0.7,
              max_tokens: 350,
            }),
          });

          const data = await response.json();
          const generatedText = data.choices[0].message.content.trim();

          const newAnswer = {
            question: userQuestion,
            answer: generatedText,
            timestamp: new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })
          };

          setCurrentAnswer(newAnswer);
          setConversationHistory(prev => [...prev, newAnswer]);
        } catch (error) {
          console.error("Erro ao gerar resposta:", error);
          setCurrentAnswer({
            question: userQuestion,
            answer: "⚠️ Ocorreu um erro ao gerar a resposta. Verifique sua conexão ou chave da OpenAI.",
            timestamp: new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })
          });
        }

        setIsProcessing(false);
        setQuestion("");
      };

      // 🔹 Tela de Login
      if (!isLoggedIn) {
        return h("div", { className: "flex items-center justify-center min-h-screen" },
          h("div", { className: "bg-white p-8 rounded-2xl shadow-xl w-full max-w-sm text-center" },
            h("h1", { className: "text-3xl font-bold text-indigo-700 mb-2" }, "🔒 Entrar no Entrevista IA"),
            h("p", { className: "text-gray-500 mb-6" }, "Acesse sua sessão segura de entrevistas inteligentes."),
            h("input", {
              type: "email",
              placeholder: "E-mail",
              value: email,
              onChange: (e) => setEmail(e.target.value),
              className: "w-full mb-3 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
            }),
            h("input", {
              type: "password",
              placeholder: "Senha",
              value: senha,
              onChange: (e) => setSenha(e.target.value),
              className: "w-full mb-3 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
            }),
            erro && h("p", { className: "text-red-500 text-sm mb-3" }, erro),
            h("button", {
              onClick: handleLogin,
              className: "w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all"
            }, "Entrar")
          )
        );
      }

      // 🔹 Tela Principal – Entrevista IA
      return h("div", { className: "container mx-auto px-4 py-8 max-w-4xl" },
        h("h1", { className: "text-3xl font-bold text-center text-indigo-700 mb-8" }, "✨ Entrevista IA"),
        h("div", { className: "bg-white p-8 rounded-2xl shadow-xl space-y-6" },
          h("div", null,
            h("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "📄 Seu Currículo"),
            h("textarea", {
              className: "w-full h-40 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-none",
              placeholder: "Cole aqui seu currículo completo...",
              value: resume,
              onChange: (e) => setResume(e.target.value)
            })
          ),
          h("div", null,
            h("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "💼 Descrição da Vaga"),
            h("textarea", {
              className: "w-full h-40 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 resize-none",
              placeholder: "Cole aqui a descrição completa da vaga...",
              value: jobDescription,
              onChange: (e) => setJobDescription(e.target.value)
            })
          ),
          h("div", null,
            h("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "❓ Pergunta do Recrutador"),
            h("textarea", {
              className: "w-full h-32 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 resize-none",
              placeholder: "Digite a pergunta feita pelo recrutador...",
              value: question,
              onChange: (e) => setQuestion(e.target.value)
            })
          ),
          h("button", {
            onClick: () => question.trim() && generateAnswer(question),
            disabled: isProcessing || !resume.trim() || !jobDescription.trim(),
            className: "w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 rounded-lg font-semibold disabled:opacity-50"
          }, isProcessing ? "⏳ Gerando resposta..." : "📤 Gerar Resposta Inteligente")
        ),

        currentAnswer && h("div", { className: "mt-6 bg-indigo-50 p-6 rounded-xl shadow-sm" },
          h("h2", { className: "font-semibold text-indigo-900 mb-2" }, "✨ Resposta sugerida:"),
          h("p", { className: "text-gray-800 leading-relaxed" }, currentAnswer.answer),
          h("p", { className: "text-xs text-gray-500 mt-4" }, "💡 Dica rápida: use o microfone para capturar perguntas discretamente durante entrevistas online.")
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("app"));
    root.render(h(App));
  </script>
</body>
</html>
